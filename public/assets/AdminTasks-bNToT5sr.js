import{d as F,K as H,p as U,k as G,r as n,l as R,P as q,o as m,c as b,b as t,B as y,s as i,f as d,t as r,y as K,e as u,T as $,w as f,v as V,x as j,G as M,H as J,A as g,C as Q,D as W,_ as X}from"./index-8Dl7ZQU3.js";import{a as I}from"./index-Ds8Rug0e.js";import{u as k}from"./useFunctions-qe69wNkG.js";import{d as Y}from"./index-BnBuZ6Y8.js";const l=p=>(Q("data-v-92f5b7c8"),p=p(),W(),p),Z={class:"container"},tt=l(()=>t("h5",{class:"fw-bold page-title mb-4"}," Tasks",-1)),et={class:"row g-4"},st=l(()=>t("div",{class:"col-md-10"},null,-1)),at={class:"col-md-2"},ot={class:"col-12"},lt={class:"card shadow-sm min-vh-100"},nt={class:"card-body"},it={class:"fw-bold text-muted"},dt=l(()=>t("span",{class:"status-indicator-inside bg-white me-2"},null,-1)),rt=l(()=>t("i",{class:"bi bi-flag-fill"},null,-1)),ct=["onClick"],ut={class:"modal fade",id:"updateTaskModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false",role:"dialog","aria-labelledby":"modalTitleId","aria-hidden":"true"},pt={class:"modal-dialog modal-dialog-scrollable modal-dialog-centered",role:"document"},_t={class:"modal-content"},mt={class:"modal-header text-capitalize border-0"},bt=l(()=>t("h5",{class:"modal-title",id:"modalTitleId"}," Update Task ",-1)),vt={class:"modal-body"},ht={class:"row g-3"},yt={class:"col-12"},ft=l(()=>t("label",{class:"form-label"},"Task Title",-1)),gt={class:"col-12"},kt=l(()=>t("label",{class:"form-label"},"Task Content",-1)),wt={class:"col-12"},Tt=l(()=>t("label",{class:"form-label"},"Priority",-1)),xt=["value"],Dt={class:"col-12"},St=l(()=>t("label",{class:"form-label"},"Due Date",-1)),Ct={class:"modal-footer border-0"},Pt=l(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),Ut={key:0,class:"btn btn-primary",type:"button",disabled:""},Vt=l(()=>t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),Mt=F({__name:"AdminTasks",setup(p){const v=Y.useToast(),w=H(),T=U({list:[]});G(()=>{h()});async function h(){try{const a=new URLSearchParams(x.value).toString(),c=(await I.adminGetAllTasks()).data;C.value=c.total,S.value=c.data,T.list=c.data,console.log(T.list,"companies.list"),A.value=!1}catch(a){console.log(a)}}const x=n({page:1,rowsPerPage:15}),D=n({page:1,rowsPerPage:15}),S=n([]),C=n(0),A=n(!0),B=[{text:"User",value:"user_task.name"},{text:"Task Name",value:"title"},{text:"Priority",value:"priority"},{text:"Created",value:"created_at"},{text:"Due Date",value:"due_date"},{text:"Status",value:"status"},{text:"",value:"action"}];R(x,a=>{h()},{deep:!0});const P=n(null),_=n(null);function L(a){s.task_id=a.id,s.title=a.title,s.content=a.content,s.due_date=a.due_date?new Date(a.due_date):new Date,s.priority=a.priority,s.user_id=a.user_id,P.value.click()}const s=U({task_id:"",user_id:"",title:"",priority:"high",content:"",due_date:new Date,isSaving:!1}),N=[{name:"High",value:"high"},{name:"Medium",value:"medium"},{name:"low",value:"low"}];async function O(){try{if(!s.title||!s.content||!s.priority){v.warning("Please complete fields",{position:"top-right"});return}s.isSaving=!0;const a=new FormData;a.append("user_id",s.user_id),a.append("task_id",s.task_id),a.append("title",s.title),a.append("content",s.content),a.append("priority",s.priority),a.append("due_date",s.due_date.toDateString());const o=await I.adminUpdateTask(a);s.isSaving=!1,_.value.click(),v.success("Task Updated",{position:"top-right"}),h()}catch(a){v.error("Something went wrong",{position:"top-right"}),console.log(a),s.isSaving=!1,_.value.click()}}return q(()=>{_.value.click()}),(a,o)=>{const c=g("router-link"),z=g("EasyDataTable"),E=g("VueDatePicker");return m(),b(M,null,[t("div",Z,[tt,t("div",et,[st,t("div",at,[y(c,{to:"/admin/tasks-assign",class:"btn btn-primary w-100"},{default:i(()=>[d("Assign Tasks")]),_:1})]),t("div",ot,[t("div",lt,[t("div",nt,[y(z,{class:"easy-data-table",headers:B,items:S.value,"buttons-pagination":"","server-options":D.value,"onUpdate:serverOptions":o[0]||(o[0]=e=>D.value=e),"server-items-length":C.value},{header:i(e=>[t("span",it,r(e.text=="#"?"S/N":e.text),1)]),"item-status":i(e=>[t("button",{class:K(["btn","btn-sm","btn-"+u(w).taskStatusColor(e.status)]),type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false"},[dt,d(" "+r(e.status),1)],2)]),"item-priority":i(e=>[t("span",{class:"fst-italic",style:$({color:u(w).taskPriorityColor(e.priority)})},[rt,d(" "+r(e.priority),1)],4)]),"item-due_date":i(e=>[d(r(u(k).dateDisplay(e.due_date)),1)]),"item-created_at":i(e=>[d(r(u(k).dateDisplay(e.created_at)),1)]),"item-action":i(e=>[t("button",{onClick:It=>L(e),class:"btn btn-sm btn-primary p-1"}," View Details ",8,ct)]),_:1},8,["items","server-options","server-items-length"])])])])])]),t("button",{ref_key:"modalOpen",ref:P,class:"d-none",type:"button","data-bs-toggle":"modal","data-bs-target":"#updateTaskModal"},null,512),t("div",ut,[t("div",pt,[t("div",_t,[t("div",mt,[bt,t("button",{ref_key:"modalClose",ref:_,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,512)]),t("div",vt,[t("div",ht,[t("div",yt,[ft,f(t("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>s.title=e),type:"text",class:"form-control"},null,512),[[V,s.title]])]),t("div",gt,[kt,f(t("textarea",{"onUpdate:modelValue":o[2]||(o[2]=e=>s.content=e),style:{height:"100px"},class:"form-control"},null,512),[[V,s.content]])]),t("div",wt,[Tt,f(t("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>s.priority=e),class:"form-select"},[(m(),b(M,null,J(N,e=>t("option",{value:e.value,key:e.value},r(e.name),9,xt)),64))],512),[[j,s.priority]])]),t("div",Dt,[St,y(E,{class:"small",format:u(k).dateDisplay,clearable:!1,"enable-time-picker":!1,"auto-apply":"",modelValue:s.due_date,"onUpdate:modelValue":o[4]||(o[4]=e=>s.due_date=e)},null,8,["format","modelValue"])])])]),t("div",Ct,[Pt,s.isSaving?(m(),b("button",Ut,[Vt,d(" Loading ")])):(m(),b("button",{key:1,onClick:O,type:"button",class:"btn btn-primary text-capitalize"}," Update task "))])])])])],64)}}}),Ot=X(Mt,[["__scopeId","data-v-92f5b7c8"]]);export{Ot as default};
