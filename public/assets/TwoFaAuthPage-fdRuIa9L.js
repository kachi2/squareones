import{d as l,u,a as p,p as f,o as a,c as i,b as e,I as _,w as h,v,g as m,f as y}from"./index-CL0QfGWs.js";import{a as b}from"./index-CY23TsXR.js";const w={class:"bg-secondary-subtle"},g={class:"container"},V={class:"everything-center overflow-hidden"},S={class:"col-md-4 col-lg-4"},T={class:"car p-3 rounded-3 shadow-sm bg-white"},x=e("div",{class:"card-header fw-bold bg-transparent"},[e("i",{class:"bi bi-lock-fill"}),y(" Two Factor Authentication ")],-1),F={class:"card-body py-3"},I={class:"col-12"},C=e("div",{class:"form-label"},"Open the two factor authentication app on your device to view your authentication code and verify your identity",-1),k={key:0,class:"small text-danger"},A={class:"col-12"},B=["disabled"],E=l({__name:"TwoFaAuthPage",setup(D){const n=u(),c=p(),t=f({isEnabled:!1,inputSecret:"",isVerifying:!1,codeInvalid:!1});async function r(){try{t.isVerifying=!0,t.codeInvalid=!1;const o=new FormData;o.append("secret",t.inputSecret);const s=await b.verifyTwoFactor(o);t.isVerifying=!1,n.twofactorAttendedTo="1",c.push({name:"Start"})}catch(o){console.log(o),o.response&&(t.codeInvalid=!0),t.isVerifying=!1}}return(o,s)=>(a(),i("div",w,[e("div",g,[e("div",V,[e("div",S,[e("div",T,[x,e("div",F,[e("form",{onSubmit:_(r,["prevent"]),class:"row g-3"},[e("div",I,[C,h(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>t.inputSecret=d),type:"text",class:"form-control exemption",placeholder:"OTP Code.."},null,512),[[v,t.inputSecret]]),t.codeInvalid?(a(),i("span",k,"Invalid Code")):m("",!0)]),e("div",A,[e("button",{disabled:t.isVerifying,type:"submit",class:"btn btn-primary w-100"},"Continue",8,B)])],32)])])])])])]))}});export{E as default};
