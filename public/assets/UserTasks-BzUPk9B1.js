import{d as J,K,T as Z,r as h,l as R,p as P,P as tt,o as c,c as r,b as t,B as U,t as i,e,y as E,G as O,H as B,g as st,U as G,w as j,x as et,f as m,J as L,v as at,A as N,C as Q,D as W,_ as X,k as ot,s as T}from"./index-C0wR_aM1.js";import{a as g}from"./index-Bc27vxtU.js";import{u as f}from"./useFunctions-CfmAuQlA.js";import{d as Y}from"./index-af_oULFB.js";const y=b=>(Q("data-v-20a73708"),b=b(),W(),b),nt={class:"modal fade",id:"tsk-cm-mdl",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false",role:"dialog","aria-labelledby":"modalTitleIdT","aria-hidden":"true"},it={class:"modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl",role:"document"},lt={class:"modal-content"},dt={class:"modal-header d-inline"},ct={class:"modal-title fw-light text-muted small float-end",id:"modalTitleIdT"},rt={class:"modal-body py-0"},ut={class:"row"},_t={class:"col-lg-7 py-3"},mt={class:"modal-title text-capitalize",id:"modalTitleIdT"},pt={class:"alert alert-warning mt-3 border-0",role:"alert"},ht={class:"table-responsive"},vt={class:"table table-primary table-borderless bg-transparent"},bt=y(()=>t("td",null,[t("i",{class:"bi bi-stars"}),m(" Status: ")],-1)),gt=y(()=>t("td",null,[t("i",{class:"bi bi-calendar"}),m(" Dates: ")],-1)),yt={class:""},kt={key:0},ft=y(()=>t("td",null,[t("i",{class:"bi bi-person"}),m(" Assignee: ")],-1)),wt={class:""},Tt=y(()=>t("td",null,[t("i",{class:"bi bi-flag-fill"}),m(" Priority: ")],-1)),Ct={class:"col-lg-5 activity-tab px-0"},xt={class:"p-3 fw-bold header shadow-sm"},St=y(()=>t("option",{value:"activities"},"Activities",-1)),Dt=y(()=>t("option",{value:"comments"},"Comments",-1)),$t=[St,Dt],Mt={key:0,class:"body"},Ot={key:1,class:"p-3 body"},It={key:0,class:"list-group list-group-flush"},Lt=y(()=>t("i",{class:"bi bi-dot"},null,-1)),Pt=y(()=>t("br",null,null,-1)),Ut={class:"fst-italic"},At={key:1,class:"list-group list-group-flush"},Bt={class:"text-muted"},Et={class:"fst-italic text-muted xsmall"},Gt={class:"p-3 footer"},Nt={class:"col-9"},Vt=["disabled"],Ft={class:"col-3"},zt=["disabled"],qt=y(()=>t("i",{class:"bi bi-send"},null,-1)),Ht=J({__name:"tasksCommentsModal",setup(b){const I=Y.useToast(),k=K(),{commentsModalIsClicked:A,currentTaskComments:V,currentTaskObj:a,currentUserType:x}=Z(k),S=h(null),D=h(null);R(()=>A.value,()=>{S.value.click(),n.activities=[],n.comments=[],n.contentShowing="activities",n.isLoading=!0,$()});const p=P({text:"",isSending:!1}),n=P({activities:[],comments:[],contentShowing:"activities",isLoading:!0});async function $(){var v,u,l,_;try{const o=x.value=="admin"?await g.adminGetTaskComments(a.value.id):await g.userGetTaskComments(a.value.id),s=x.value=="admin"?await g.adminGetTaskActivities(a.value.id):await g.userGetTaskActivities(a.value.id);n.activities=((u=(v=s==null?void 0:s.data)==null?void 0:v.data)==null?void 0:u.data)??[],n.comments=((_=(l=o==null?void 0:o.data)==null?void 0:l.data)==null?void 0:_.data)??[],n.isLoading=!1}catch{n.isLoading=!1}}async function M(){if(p.text)try{p.isSending=!0;const v=new FormData;v.append("task_id",a.value.id),v.append("comment",p.text);const u=x.value=="admin"?await g.adminSendTaskComment(v):await g.userSendTaskComment(v);p.text="",$(),p.isSending=!1}catch{p.isSending=!1,I.error("Something went wrong with your request")}}return tt(()=>{D.value.click()}),(v,u)=>{var o,s,w,F,z,q;const l=N("modalCloseBtn"),_=N("isLoadingComponent");return c(),r(O,null,[t("button",{ref_key:"taskModalOpener",ref:S,type:"button",class:"d-none","data-bs-toggle":"modal","data-bs-target":"#tsk-cm-mdl"},null,512),t("div",nt,[t("div",it,[t("div",lt,[t("div",dt,[U(l,{class:"float-end ms-5"}),t("h5",ct," Created "+i(`${e(f).dateDisplay(e(a).created_at)}`),1)]),t("div",rt,[t("div",ut,[t("div",_t,[t("h5",mt,i((o=e(a))==null?void 0:o.title),1),t("div",pt,i((s=e(a))==null?void 0:s.content),1),t("div",ht,[t("table",vt,[t("tbody",null,[t("tr",null,[bt,t("td",null,[t("span",{class:E(`text-${e(k).taskStatusColor(e(a).status)}`)},i(e(a).status),3)]),(c(),r(O,null,B(10,d=>t("td")),64))]),t("tr",null,[gt,t("td",null,[t("span",yt,i(` ${e(f).dateDisplay(e(a).created_at)} -
                                                    ${e(f).dateDisplay(e(a).due_date)}`),1)])]),(F=(w=e(a))==null?void 0:w.user_task)!=null&&F.name?(c(),r("tr",kt,[ft,t("td",null,[t("span",wt,i(((q=(z=e(a))==null?void 0:z.user_task)==null?void 0:q.name)??""),1)])])):st("",!0),t("tr",null,[Tt,t("td",null,[t("span",{style:G({color:e(k).taskPriorityColor(e(a).priority)})},i(e(a).priority),5)])])])])])]),t("div",Ct,[t("div",xt,[j(t("select",{"onUpdate:modelValue":u[0]||(u[0]=d=>n.contentShowing=d),class:"form-select bg-dynamic fw-bold"},$t,512),[[et,n.contentShowing]])]),n.isLoading?(c(),r("div",Mt,[U(_)])):(c(),r("div",Ot,[n.contentShowing!="comments"?(c(),r("ul",It,[(c(!0),r(O,null,B(n.activities,d=>(c(),r("li",{key:d.id,class:"list-group-item border-0 px-0"},[Lt,m(" "+i(d.activity)+" ",1),Pt,t("span",Ut,i(e(f).dateDisplay(d.created_at,"m,y,t")),1)]))),128))])):(c(),r("ul",At,[(c(!0),r(O,null,B(n.comments,d=>{var H;return c(),r("li",{key:d.id,class:"list-group-item px-0"},[t("div",Bt,i((H=d==null?void 0:d.users)==null?void 0:H.name),1),t("div",null,i(d.comment),1),t("div",Et,i(e(f).dateDisplay(d.created_at,"m,y,t")),1)])}),128))]))])),t("div",Gt,[t("form",{onSubmit:L(M,["prevent"]),class:"row g - 3"},[t("div",Nt,[j(t("input",{disabled:n.contentShowing!="comments","onUpdate:modelValue":u[1]||(u[1]=d=>p.text=d),type:"text",class:"form-control",placeholder:"enter comment here.."},null,8,Vt),[[at,p.text]])]),t("div",Ft,[t("button",{disabled:p.isSending||n.contentShowing!="comments",type:"submit",class:"btn btn-primary w-100"},[qt,m(" Send ")],8,zt)])],32)])])])]),t("button",{ref_key:"taskModalCloser",ref:D,type:"button",class:"btn btn-secondary d-none","data-bs-dismiss":"modal"}," Close ",512)])])])],64)}}}),jt=X(Ht,[["__scopeId","data-v-20a73708"]]),C=b=>(Q("data-v-97baf036"),b=b(),W(),b),Jt={class:"container"},Kt=C(()=>t("h5",{class:"fw-bold page-title mb-4"}," Tasks",-1)),Rt={class:"row g-4"},Qt={class:"col-12"},Wt={class:"card shadow-sm min-vh-100"},Xt={class:"card-body"},Yt={class:"fw-bold text-muted"},Zt={class:"status-dropdown"},ts={class:"dropdown"},ss=C(()=>t("span",{class:"status-indicator-inside bg-white me-2"},null,-1)),es={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},as=["onClick"],os=C(()=>t("span",{class:"status-indicator"},null,-1)),ns=["onClick"],is=C(()=>t("span",{class:"status-indicator"},null,-1)),ls=["onClick"],ds=C(()=>t("span",{class:"status-indicator"},null,-1)),cs=C(()=>t("i",{class:"bi bi-flag-fill"},null,-1)),rs={key:1},us=["onClick"],_s=J({__name:"UserTasks",setup(b){const I=Y.useToast(),k=K(),A=P({list:[]});ot(()=>{a(),V()});async function V(){await g.updateAllUserTask()}async function a(){try{M.value=!0;const l=new URLSearchParams(S.value).toString(),o=(await g.userGetTasks()).data.data;$.value=o.total,n.value=o.data,A.list=o.data,M.value=!1}catch(l){console.log(l)}}function x(l){const _=new Date(l);return new Date>_}const S=h({page:1,rowsPerPage:15}),D=h({page:1,rowsPerPage:15}),p=h("red"),n=h([]),$=h(0),M=h(!0),v=[{text:"Task Title",value:"title"},{text:"Tasks",value:"content"},{text:"Priority",value:"priority"},{text:"Status",value:"status"},{text:"Date Created",value:"created_at"},{text:"Due Date",value:"due_date"},{text:"",value:"comment"}];R(S,l=>{a()},{deep:!0}),h(null),h(null),h("pending"),P({task_id:"",user_id:"",title:"",priority:"high",content:"",due_date:new Date,isSaving:!1});async function u(l,_){try{const o=new FormData;o.append("user_id",l.user_id),o.append("task_id",l.id),o.append("status",_),console.log(l);const s=await g.userUpdateTask(o);I.success("Task Updated",{position:"top-right"}),a()}catch(o){I.error("Something went wrong",{position:"top-right"}),console.log(o)}}return(l,_)=>{const o=N("EasyDataTable");return c(),r(O,null,[t("div",Jt,[Kt,t("div",Rt,[t("div",Qt,[t("div",Wt,[t("div",Xt,[U(o,{loading:M.value,class:"easy-data-table",headers:v,items:n.value,"buttons-pagination":"","server-options":D.value,"onUpdate:serverOptions":_[0]||(_[0]=s=>D.value=s),"server-items-length":$.value},{header:T(s=>[t("span",Yt,i(s.text=="#"?"S/N":s.text),1)]),"item-status":T(s=>[t("div",Zt,[t("div",ts,[t("button",{class:E(["btn","dropdown-toggle","btn-sm","btn-"+e(k).taskStatusColor(s.status)]),type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false"},[ss,m(" "+i(s.status),1)],2),t("ul",es,[t("li",null,[t("a",{class:"dropdown-item status-todo",style:G({color:e(k).taskStatusColor("TODO")}),href:"#",onClick:L(w=>u(s,"TO-DO"),["prevent"])},[os,m(" TO DO")],12,as)]),t("li",null,[t("a",{class:"dropdown-item status-doing",href:"#",onClick:L(w=>u(s,"DOING"),["prevent"])},[is,m(" DOING")],8,ns)]),t("li",null,[t("a",{class:"dropdown-item status-complete",href:"#",onClick:L(w=>u(s,"COMPLETE"),["prevent"])},[ds,m(" COMPLETE")],8,ls)])])])])]),"item-priority":T(s=>[t("span",{class:"",style:G({color:e(k).taskPriorityColor(s.priority)})},[cs,m(" "+i(s.priority),1)],4)]),"item-due_date":T(s=>[x(s.due_date)?(c(),r("span",{key:0,class:E(p.value)},i(e(f).dateDisplay(s.due_date)),3)):(c(),r("span",rs,i(e(f).dateDisplay(s.due_date)),1))]),"item-created_at":T(s=>[m(i(e(f).dateDisplay(s.created_at)),1)]),"item-comment":T(s=>[t("button",{onClick:w=>e(k).openTaskCommentModal(s,"user"),class:"btn btn-warning"}," Comments ",8,us)]),_:1},8,["loading","items","server-options","server-items-length"])])])])])]),U(jt)],64)}}}),bs=X(_s,[["__scopeId","data-v-97baf036"]]);export{bs as default};
